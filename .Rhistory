install.packages(c("fastICA", "ggfortify"))
knitr::opts_chunk$set(echo = TRUE, eval = T)
library(ggplot2)
library(tidyverse)
library(ggfortify)
library(fastICA)
# read in Auto data
Auto_data <- read_csv("/Users/ericachio/Documents/sackler/machine learning/hw1-ericachio/Auto.csv")
#remove cars with unknown horsepower and set horsepower to numeric
Auto_data <- Auto_data %>%
filter(horsepower != "?") %>%
mutate(horsepower = as.numeric(horsepower)) %>%
as.data.frame()
#save car names
Auto_data_names <- Auto_data$name
#data to cluster
Auto_data_clust <- Auto_data[,1:8]
dim(Auto_data_clust)
#392 is too much for a demo, so lets take the first 25
Auto_data_clust <- Auto_data_clust[1:25,]
rownames(Auto_data_clust) <- Auto_data_names[1:25]
knitr::opts_chunk$set(echo = TRUE, eval = T)
library(ggplot2)
library(tidyverse)
library(ggfortify)
library(fastICA)
# read in Auto data
Auto_data <- read_csv("/Users/ericachio/Documents/sackler/machine learning/hw1-ericachio/Auto.csv")
#remove cars with unknown horsepower and set horsepower to numeric
Auto_data <- Auto_data %>%
filter(horsepower != "?") %>%
mutate(horsepower = as.numeric(horsepower)) %>%
as.data.frame()
#save car names
Auto_data_names <- Auto_data$name
#data to cluster
Auto_data_clust <- Auto_data[,1:8]
dim(Auto_data_clust)
#392 is too much for a demo, so lets take the first 25
Auto_data_clust <- Auto_data_clust[1:25,]
rownames(Auto_data_clust) <- Auto_data_names[1:25]
help("dist")
hierarchical_dist <- as.matrix(dist(Auto_data_clust, method = "euclidean"))
#View(hierarchical_dist)
diag(hierarchical_dist) <- NA
arrayInd(which.min(hierarchical_dist), dim(hierarchical_dist))
#postitions 23 and 15 are the most similar. Lets go back to the names of the cars
Auto_data_names[23]
Auto_data_names[15]
#replace pos 15 with the average of pos 15 and 23
hierarchical_dist[,15] <- apply((hierarchical_dist[,c(23,15)]),1,mean)
hierarchical_dist[15,] <- apply((hierarchical_dist[c(23,15),]),2,mean)
#remove pos 23
hierarchical_dist <- hierarchical_dist[-23,-23]
#now position 15 represents the cluster containing the saab99e and the toyota corona mark ii
diag(hierarchical_dist) <- NA
arrayInd(which.min(hierarchical_dist), dim(hierarchical_dist))
#postitions 4 and 3 are the most similar
Auto_data_names[4]
Auto_data_names[3]
hierarchical_dist <- dist(Auto_data_clust, method = "euclidean")
tree <- hclust(hierarchical_dist, method="average")
plot(tree)
#help(cutree)
# cut tree into 3 clusters
tree <- hclust(hierarchical_dist, method="average")
plot(tree)
tree_k2 <- cutree(tree, k = 2)
# plot the tree before running this line
rect.hclust(tree, k = 3, h = NULL)
#help(cutree)
# cut tree into 3 clusters
tree <- hclust(hierarchical_dist, method="average")
plot(tree)
tree_k2 <- cutree(tree, k = 2)
# plot the tree before running this line
rect.hclust(tree, k = 3, h = NULL)
